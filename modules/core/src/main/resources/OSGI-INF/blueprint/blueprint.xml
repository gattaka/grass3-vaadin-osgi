<?xml version="1.0" encoding="UTF-8"?>
<blueprint xmlns="http://www.osgi.org/xmlns/blueprint/v1.0.0">

	<!-- Vytvoř si instanci od factory pro vytváření aplikace apod. -->
	<bean id="appFactory" class="org.myftp.gattserver.grass3.AppFactory">
	</bean>

	<!-- ServiceHolder - agregátor služeb -->
	<bean id="serviceHolder" class="org.myftp.gattserver.grass3.ServiceHolder"
		factory-method="getInstance" activation="eager">
		<property name="sectionServices" ref="sectionServices" />
	</bean>

	<!-- List s odchytnutými sekcemi -->
	<reference-list id="sectionServices"
		interface="org.myftp.gattserver.grass3.ISection" availability="optional">  <!-- activation="lazy" -->
		<reference-listener bind-method="bindSection"
			unbind-method="unbindSection" ref="serviceHolder" />
	</reference-list>

	<!-- Registrace služby implementující ApplicationFactory -->
	<service interface="vaadin.bridge.ApplicationFactory" ref="appFactory">
		<!-- Parametrem factory je URI alias, na kterém je web aplikace registrován -->
		<service-properties>
			<entry key="alias" value="grass3" />
		</service-properties>
	</service>

</blueprint>
